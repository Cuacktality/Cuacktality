// Datos de los proyectos de Diseño Gráfico / Animación
const datosProyectos = {
  personajes3d: {
    nombre: "Personajes 3D",
    subtitulo: "Modelado y Animación de Criaturas y Avatares", // Subtítulo para el proyecto
    personajes: [
      {
        id: "nexus-01",
        nombre: "Nexus-01",
        subtitulo: "Unidad Sintética",
        descripcion:
          "Unidad sintética diseñada para mapear emociones humanas. Comanda protocolos de defensa y análisis existencial.",
        icono: "assets/icons/personaje1.png",
        thumbnail: "assets/thumbnails/personaje1.png",
        renders: [
          "assets/renders/personaje1_00.png",
          "assets/renders/personaje1_01.png",
          "assets/renders/personaje1_02.png",
          "assets/renders/personaje1_03.png",
          "assets/renders/personaje1_04.png",
          "assets/renders/personaje1_05.png",
          "assets/renders/personaje1_06.png",
          "assets/renders/personaje1_07.png",
          "assets/renders/personaje1_08.png",
          "assets/renders/personaje1_09.png",
        ],
      },
      {
        id: "zaira",
        nombre: "Zaira",
        subtitulo: "Agente Psiónica",
        descripcion:
          "Agente psiónica con habilidades de reconexión neural. Habita el borde entre la realidad y el impulso cuántico.",
        icono: "assets/icons/personaje2.png",
        thumbnail: "assets/thumbnails/personaje2.png",
        renders: [
          "assets/renders/personaje2_00.png",
          "assets/renders/personaje2_01.png",
          "assets/renders/personaje2_02.png",
          "assets/renders/personaje2_03.png",
          "assets/renders/personaje2_04.png",
          "assets/renders/personaje2_05.png",
          "assets/renders/personaje2_06.png",
          "assets/renders/personaje2_07.png",
          "assets/renders/personaje2_08.png",
          "assets/renders/personaje2_09.png",
        ],
      },
      {
        id: "aegon",
        nombre: "Aegon",
        subtitulo: "Guardián Dimensional",
        descripcion:
          "Guardián del colapso dimensional. Porta un núcleo fragmentado que alberga memorias prohibidas de antiguos universos.",
        icono: "assets/icons/personaje3.png",
        thumbnail: "assets/thumbnails/personaje3.png",
        renders: [
          "assets/renders/personaje3_00.png",
          "assets/renders/personaje3_01.png",
          "assets/renders/personaje3_02.png",
          "assets/renders/personaje3_03.png",
          "assets/renders/personaje3_04.png",
          "assets/renders/personaje3_05.png",
          "assets/renders/personaje3_06.png",
          "assets/renders/personaje3_07.png",
          "assets/renders/personaje3_08.png",
          "assets/renders/personaje3_09.png",
        ],
      },
      {
        id: "kael",
        nombre: "Kael",
        subtitulo: "Explorador Paralelo",
        descripcion:
          "Explorador de dimensiones paralelas. Su armadura se adapta a cualquier entorno, fusionándose con la energía del lugar.",
        icono: "assets/icons/personaje4.png",
        thumbnail: "assets/thumbnails/personaje4.png",
        renders: [
          "assets/renders/personaje4_00.png",
          "assets/renders/personaje4_01.png",
          "assets/renders/personaje4_02.png",
          "assets/renders/personaje4_03.png",
          "assets/renders/personaje4_04.png",
          "assets/renders/personaje4_05.png",
          "assets/renders/personaje4_06.png",
          "assets/renders/personaje4_07.png",
          "assets/renders/personaje4_08.png",
          "assets/renders/personaje4_09.png",
        ],
      },
      {
        id: "lyra",
        nombre: "Lyra",
        subtitulo: "Cantante Estelar",
        descripcion:
          "Cantante de las estrellas, sus melodías pueden alterar la realidad. Busca los fragmentos de una canción olvidada.",
        icono: "assets/icons/personaje5.png",
        thumbnail: "assets/thumbnails/personaje5.png",
        renders: [
          "assets/renders/personaje5_00.png",
          "assets/renders/personaje5_01.png",
          "assets/renders/personaje5_02.png",
          "assets/renders/personaje5_03.png",
          "assets/renders/personaje5_04.png",
          "assets/renders/personaje5_05.png",
          "assets/renders/personaje5_06.png",
          "assets/renders/personaje5_07.png",
          "assets/renders/personaje5_08.png",
          "assets/renders/personaje5_09.png",
        ],
      },
      {
        id: "roric",
        nombre: "Roric",
        subtitulo: "Guerrero Volcánico",
        descripcion:
          "Guerrero forjado en el corazón de un volcán. Su fuerza es legendaria y su temperamento, explosivo.",
        icono: "assets/icons/personaje6.png",
        thumbnail: "assets/thumbnails/personaje6.png",
        renders: [
          "assets/renders/personaje6_00.png",
          "assets/renders/personaje6_01.png",
          "assets/renders/personaje6_02.png",
          "assets/renders/personaje6_03.png",
          "assets/renders/personaje6_04.png",
          "assets/renders/personaje6_05.png",
          "assets/renders/personaje6_06.png",
          "assets/renders/personaje6_07.png",
          "assets/renders/personaje6_08.png",
          "assets/renders/personaje6_09.png",
        ],
      },
      {
        id: "seraphina",
        nombre: "Seraphina",
        subtitulo: "Custodia Cósmica",
        descripcion:
          "Custodia de la flora cósmica. Cada flor que cultiva tiene propiedades únicas y un secreto ancestral.",
        icono: "assets/icons/personaje7.png",
        thumbnail: "assets/thumbnails/personaje7.png",
        renders: [
          "assets/renders/personaje7_00.png",
          "assets/renders/personaje7_01.png",
          "assets/renders/personaje7_02.png",
          "assets/renders/personaje7_03.png",
          "assets/renders/personaje7_04.png",
          "assets/renders/personaje7_05.png",
          "assets/renders/personaje7_06.png",
          "assets/renders/personaje7_07.png",
          "assets/renders/personaje7_08.png",
          "assets/renders/personaje7_09.png",
        ],
      },
      {
        id: "jax",
        nombre: "Jax",
        subtitulo: "Hacker Vigilante",
        descripcion:
          "Hacker y vigilante de la red. Sus implantes cibernéticos le permiten navegar por el ciberespacio a velocidades inimaginables.",
        icono: "assets/icons/personaje8.png",
        thumbnail: "assets/thumbnails/personaje8.png",
        renders: [
          "assets/renders/personaje8_00.png",
          "assets/renders/personaje8_01.png",
          "assets/renders/personaje8_02.png",
          "assets/renders/personaje8_03.png",
          "assets/renders/personaje8_04.png",
          "assets/renders/personaje8_05.png",
          "assets/renders/personaje8_06.png",
          "assets/renders/personaje8_07.png",
          "assets/renders/personaje8_08.png",
          "assets/renders/personaje8_09.png",
        ],
      },
      {
        id: "elara",
        nombre: "Elara",
        subtitulo: "Arquera Mística",
        descripcion:
          "Arquera mística, sus flechas nunca fallan su objetivo. Protege un antiguo bosque de las sombras.",
        icono: "assets/icons/personaje9.png",
        thumbnail: "assets/thumbnails/personaje9.png",
        renders: [
          "assets/renders/personaje9_00.png",
          "assets/renders/personaje9_01.png",
          "assets/renders/personaje9_02.png",
          "assets/renders/personaje9_03.png",
          "assets/renders/personaje9_04.png",
          "assets/renders/personaje9_05.png",
          "assets/renders/personaje9_06.png",
          "assets/renders/personaje9_07.png",
          "assets/renders/personaje9_08.png",
          "assets/renders/personaje9_09.png",
        ],
      },
      {
        id: "volkov",
        nombre: "Volkov",
        subtitulo: "Cazador Solitario",
        descripcion:
          "Cazador solitario de las tundras heladas. Su lealtad es inquebrantable y su puntería, letal.",
        icono: "assets/icons/personaje10.png",
        thumbnail: "assets/thumbnails/personaje10.png",
        renders: [
          "assets/renders/personaje10_00.png",
          "assets/renders/personaje10_01.png",
          "assets/renders/personaje10_02.png",
          "assets/renders/personaje10_03.png",
          "assets/renders/personaje10_04.png",
          "assets/renders/personaje10_05.png",
          "assets/renders/personaje10_06.png",
          "assets/renders/personaje10_07.png",
          "assets/renders/personaje10_08.png",
          "assets/renders/personaje10_09.png",
        ],
      },
      {
        id: "anya",
        nombre: "Anya",
        subtitulo: "Hechicera de Sueños",
        descripcion:
          "Hechicera de los sueños, puede entrar en las mentes de otros. Busca un artefacto que le otorgue control total.",
        icono: "assets/icons/personaje11.png",
        thumbnail: "assets/thumbnails/personaje11.png",
        renders: [
          "assets/renders/personaje11_00.png",
          "assets/renders/personaje11_01.png",
          "assets/renders/personaje11_02.png",
          "assets/renders/personaje11_03.png",
          "assets/renders/personaje11_04.png",
          "assets/renders/personaje11_05.png",
          "assets/renders/personaje11_06.png",
          "assets/renders/personaje11_07.png",
          "assets/renders/personaje11_08.png",
          "assets/renders/personaje11_09.png",
        ],
      },
      {
        id: "drakon",
        nombre: "Drakon",
        subtitulo: "Criatura Abisal",
        descripcion:
          "Criatura marina legendaria, guardián de los tesoros hundidos. Su aliento puede invocar tormentas.",
        icono: "assets/icons/personaje12.png",
        thumbnail: "assets/thumbnails/personaje12.png",
        renders: [
          "assets/renders/personaje12_00.png",
          "assets/renders/personaje12_01.png",
          "assets/renders/personaje12_02.png",
          "assets/renders/personaje12_03.png",
          "assets/renders/personaje12_04.png",
          "assets/renders/personaje12_05.png",
          "assets/renders/personaje12_06.png",
          "assets/renders/personaje12_07.png",
          "assets/renders/personaje12_08.png",
          "assets/renders/personaje12_09.png",
        ],
      },
    ],
  },
  disenoLogotipos: {
    nombre: "Diseño de Logotipos",
    subtitulo: "Creación de Identidades Visuales Impactantes", // Subtítulo para el proyecto
    personajes: [
      {
        id: "logo1",
        nombre: "Logo Astro",
        subtitulo: "Identidad Corporativa",
        descripcion:
          "Diseño de logotipo moderno y adaptable para la empresa Astro, con variantes para diferentes aplicaciones.",
        icono: "assets/icons/logo_design.png",
        thumbnail: "https://placehold.co/80x80/FF5733/FFFFFF?text=L1",
        renders: [
          "https://placehold.co/400x300/FF5733/FFFFFF?text=Logo+Astro+1",
          "https://placehold.co/400x300/FF5733/000000?text=Logo+Astro+2",
          "https://placehold.co/400x300/FF5733/CCCCCC?text=Logo+Astro+3",
        ],
      },
      {
        id: "logo2",
        nombre: "Logo Tech",
        subtitulo: "Marca Tecnológica",
        descripcion:
          "Logotipo minimalista y futurista para una startup de tecnología, enfocado en la escalabilidad y reconocimiento.",
        icono: "assets/icons/logo_design.png",
        thumbnail: "https://placehold.co/80x80/33FF57/FFFFFF?text=L2",
        renders: [
          "https://placehold.co/400x300/33FF57/FFFFFF?text=Logo+Tech+1",
          "https://placehold.co/400x300/33FF57/000000?text=Logo+Tech+2",
        ],
      },
    ],
  },
  animacion2d: {
    nombre: "Animación 2D",
    subtitulo: "Exploración de Motion Graphics y Narrativas Animadas", // Subtítulo para el proyecto
    personajes: [
      {
        id: "animacion1",
        nombre: "Corto Urbano",
        subtitulo: "Motion Graphics",
        descripcion:
          "Secuencia de motion graphics que captura la energía de la vida urbana, utilizando tipografía dinámica y transiciones fluidas.",
        icono: "assets/icons/animation_2d.png",
        thumbnail: "https://placehold.co/80x80/FF33A1/FFFFFF?text=A1",
        renders: [
          "https://placehold.co/400x300/FF33A1/FFFFFF?text=Animacion+Urbana+1",
          "https://placehold.co/400x300/FF33A1/000000?text=Animacion+Urbana+2",
        ],
      },
      {
        id: "animacion2",
        nombre: "Intro de Juego",
        subtitulo: "Animación de Título",
        descripcion:
          "Intro animada para un videojuego, combinando elementos gráficos y sonoros para crear una experiencia inmersiva.",
        icono: "assets/icons/animation_2d.png",
        thumbnail: "https://placehold.co/80x80/A1FF33/FFFFFF?text=A2",
        renders: [
          "https://placehold.co/400x300/A1FF33/FFFFFF?text=Intro+Juego+1",
          "https://placehold.co/400x300/A1FF33/000000?text=Intro+Juego+2",
        ],
      },
    ],
  },
};

let proyectoActualKey = "personajes3d"; // El proyecto inicialmente seleccionado
let personajeActualId = "nexus-01"; // El personaje inicial dentro del proyecto
let anguloActual = 0; // El índice del render actual del personaje

// Función para obtener un personaje por su ID dentro del proyecto actual
function obtenerPersonajeActual() {
  const proyecto = datosProyectos[proyectoActualKey];
  if (!proyecto || !proyecto.personajes) return null;
  return proyecto.personajes.find((p) => p.id === personajeActualId);
}

// Función para mostrar los proyectos en la lista principal
function cargarListaProyectos() {
  const listaProyectosUl = document.getElementById("listaProyectos");
  listaProyectosUl.innerHTML = ""; // Limpiar lista existente

  for (const key in datosProyectos) {
    const proyecto = datosProyectos[key];
    const li = document.createElement("li");
    li.setAttribute("data-proyecto-key", key);
    li.classList.add("proyecto-item");
    if (key === proyectoActualKey) {
      li.classList.add("activo");
    }

    li.innerHTML = `
      <span class="proyecto-nombre">${proyecto.nombre}</span>
      <span class="proyecto-subtitulo-lista">${proyecto.subtitulo}</span>
    `;
    li.onclick = () => seleccionarProyecto(key);
    listaProyectosUl.appendChild(li);
  }
}

// Función para seleccionar un proyecto y cargar sus personajes
function seleccionarProyecto(key) {
  proyectoActualKey = key;
  const proyecto = datosProyectos[key];

  // Actualizar clase 'activo' en la lista de proyectos
  document.querySelectorAll(".proyecto-item").forEach((item) => {
    item.classList.remove("activo");
  });
  document
    .querySelector(`[data-proyecto-key="${key}"]`)
    .classList.add("activo");

  // Seleccionar el primer personaje del nuevo proyecto por defecto
  if (proyecto.personajes && proyecto.personajes.length > 0) {
    seleccionarPersonaje(proyecto.personajes[0].id);
  } else {
    // Si no hay personajes en el proyecto, limpiar el visor y la información
    document.getElementById("iconoPersonaje").src = "assets/icons/default.png";
    document.getElementById("nombrePersonaje").textContent = "Sin Personaje";
    document.getElementById("subtituloPersonaje").textContent = "N/A";
    document.getElementById("descripcionPersonaje").textContent =
      "Este proyecto no tiene personajes asociados.";
    document.getElementById("modeloPersonaje").src =
      "https://placehold.co/400x300/000000/FFFFFF?text=Sin+Contenido";
    document.getElementById("modeloPersonaje").alt = "Sin contenido";
    document.getElementById("nombreElementoVisor").textContent = "";
    document.getElementById("thumbnailsPersonajes").innerHTML = "";
  }
}

// Función para cargar las miniaturas de los personajes del proyecto actual
function cargarMiniaturasPersonajes() {
  const thumbnailsContainer = document.getElementById("thumbnailsPersonajes");
  thumbnailsContainer.innerHTML = ""; // Limpiar miniaturas existentes

  const proyecto = datosProyectos[proyectoActualKey];
  if (proyecto.personajes) {
    proyecto.personajes.forEach((personaje) => {
      const img = document.createElement("img");
      img.src = personaje.thumbnail;
      img.alt = personaje.nombre;
      img.classList.add("thumbnail-personaje");
      if (personaje.id === personajeActualId) {
        img.classList.add("activo");
      }
      img.onclick = () => seleccionarPersonaje(personaje.id);
      thumbnailsContainer.appendChild(img);
    });
  }
}

// Función para seleccionar un personaje específico y mostrar su información y render
function seleccionarPersonaje(id) {
  personajeActualId = id;
  anguloActual = 0; // Reiniciar el ángulo al cambiar de personaje

  const personaje = obtenerPersonajeActual();

  if (personaje) {
    // Actualizar información del personaje
    const iconoPersonajeImg = document.getElementById("iconoPersonaje");
    iconoPersonajeImg.src = personaje.icono;
    // Re-trigger animation for icon
    iconoPersonajeImg.classList.remove("salto");
    void iconoPersonajeImg.offsetWidth; // Trigger reflow
    iconoPersonajeImg.classList.add("salto");

    document.getElementById("nombrePersonaje").textContent = personaje.nombre;
    document.getElementById("subtituloPersonaje").textContent =
      personaje.subtitulo;
    document.getElementById("descripcionPersonaje").textContent =
      personaje.descripcion;

    // Actualizar el visor de render
    actualizarRenderPersonaje();

    // Actualizar la lista de miniaturas de personajes
    cargarMiniaturasPersonajes(); // Recargar para actualizar el estado activo
  }
}

// Función para actualizar la imagen principal del visor (render rotativo)
function actualizarRenderPersonaje() {
  const personaje = obtenerPersonajeActual();
  if (!personaje || !personaje.renders || personaje.renders.length === 0) {
    document.getElementById("modeloPersonaje").src =
      "https://placehold.co/400x300/000000/FFFFFF?text=Sin+Renders";
    document.getElementById("modeloPersonaje").alt = "Sin renders disponibles";
    document.getElementById("nombreElementoVisor").textContent = "Sin Renders";
    return;
  }

  const rutaRender = personaje.renders[anguloActual];
  const modeloPersonajeImg = document.getElementById("modeloPersonaje");
  modeloPersonajeImg.src = rutaRender;
  modeloPersonajeImg.alt = `Render de ${personaje.nombre} - ángulo ${anguloActual}`;

  // Actualizar el nombre del elemento en el visor
  document.getElementById("nombreElementoVisor").textContent = personaje.nombre;

  // Añadir animación de iluminación
  modeloPersonajeImg.classList.add("iluminando");
  setTimeout(() => {
    modeloPersonajeImg.classList.remove("iluminando");
  }, 600);
}

// Función para rotar el personaje en el visor
function rotarPersonaje(direccion) {
  const personaje = obtenerPersonajeActual();
  if (!personaje || !personaje.renders || personaje.renders.length === 0)
    return;

  anguloActual =
    (anguloActual + direccion + personaje.renders.length) %
    personaje.renders.length;
  actualizarRenderPersonaje();
}

// Inicializar la sección al cargar la página
window.addEventListener("DOMContentLoaded", () => {
  cargarListaProyectos();
  seleccionarProyecto(proyectoActualKey); // Mostrar el primer proyecto y su primer personaje por defecto
});
